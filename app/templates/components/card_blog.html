<div class="col-lg-4 col-md-4">
  <article
    class="card blog-card h-100 border-0 shadow-sm"
    itemscope
    itemtype="https://schema.org/BlogPosting"
  >
    <!-- Blog Image -->
    <div class="position-relative overflow-hidden">
      {% set media_info = blog.get_media_seo_info() if blog.image else None %}

      <img
        src="{{ blog.image if blog.image else 'https://via.placeholder.com/400x250/FFC107/FFFFFF?text=Blog' }}"
        class="card-img-top"
        alt="{{ media_info.alt_text if media_info and media_info.alt_text else blog.title }}"
        title="{{ media_info.title if media_info and media_info.title else blog.title }}"
        itemprop="image"
        loading="lazy"
      />

      {% if media_info and media_info.caption %}
      <div class="visually-hidden" itemprop="description">
        {{ media_info.caption }}
      </div>
      {% endif %}

      {% if blog.is_featured %}
      <span class="badge bg-warning position-absolute top-0 start-0 m-2">
        <i class="bi bi-star-fill"></i> Nổi bật
      </span>
      {% endif %}
    </div>

    <!-- Blog Content -->
    <div class="card-body d-flex flex-column">
      <!-- Meta Info -->
      <div class="d-flex align-items-center text-muted small mb-3 flex-wrap">
        <span class="me-3" itemprop="datePublished" content="{{ blog.created_at.strftime('%Y-%m-%d') }}">
          <i class="bi bi-calendar3 text-warning"></i>
          {{ blog.created_at|vn_date }}
        </span>
        <span class="me-3">
          <i class="bi bi-eye text-warning"></i> {{ blog.views }}
        </span>
        {% if blog.author %}
        <span class="me-3" itemprop="author" itemscope itemtype="https://schema.org/Person">
          <i class="bi bi-person text-warning"></i>
          <span itemprop="name">{{ blog.author }}</span>
        </span>
        {% endif %}
      </div>

      <!-- Title -->
      <h5 class="card-title text-truncate-2 mb-3">
        <a
          href="{{ url_for('main.blog_detail', slug=blog.slug) }}"
          class="text-decoration-none text-dark"
          itemprop="headline"
        >
          {{ blog.title }}
        </a>
      </h5>

      <!-- Excerpt -->
      <p class="card-text text-muted small mb-4" itemprop="description">
        {{ (blog.excerpt or blog.content|striptags)[:120] }}...
      </p>

      <!-- Read More Button -->
      <div class="mt-auto">
        <a
          href="{{ url_for('main.blog_detail', slug=blog.slug) }}"
          class="btn btn-warning btn-sm fw-bold"
          itemprop="url"
        >
          Đọc thêm <i class="bi bi-arrow-right ms-1"></i>
        </a>
      </div>

      <!-- Hidden SEO metadata -->
      <meta
        itemprop="dateModified"
        content="{{ blog.updated_at|vn_datetime('%Y-%m-%d') if blog.updated_at else blog.created_at|vn_datetime('%Y-%m-%d') }}"
      />
      <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <meta itemprop="name" content="{{ get_setting('website_name', 'BRICON VIỆT NAM') }}" />
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
          <meta
            itemprop="url"
            content="{{ get_setting('logo_url', url_for('static', filename='img/logo.png', _external=True)) }}"
          />
        </div>
      </div>
    </div>
  </article>
</div>
