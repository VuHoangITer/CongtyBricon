<div class="col-lg-4 col-md-4 col-sm-6 col-6">
  <div class="card product-card h-100 border-0 shadow-sm">
    <!-- Product Image -->
    <div class="product-image position-relative">
      {% set media_info = product.get_media_seo_info() if product.image else None %}

      <img
        src="{{ product.image if product.image else 'https://via.placeholder.com/300x300/FFC107/FFFFFF?text=Product' }}"
        class="card-img-top"
        alt="{{ media_info.alt_text if media_info and media_info.alt_text else product.name }}"
        title="{{ media_info.title if media_info and media_info.title else product.name }}"
        loading="lazy"
      />

      <!-- Caption ẩn cho SEO -->
      {% if media_info and media_info.caption %}
      <div class="visually-hidden">{{ media_info.caption }}</div>
      {% endif %}

      <!-- Badge giảm giá -->
      {% if product.old_price and product.price > 0 %}
      <span
        class="badge bg-danger position-absolute top-0 start-0 m-2 px-2 py-1 fs-6 shadow-sm"
      >
        {{ ((product.old_price - product.price) / product.old_price * 100)|int }}%
      </span>
      {% endif %}
    </div>

    <!-- Product Info -->
    <div class="card-body d-flex flex-column text-center">
      <h5 class="product-name mb-2">
        <a
          href="{{ url_for('main.product_detail', slug=product.slug) }}"
          class="text-decoration-none text-dark"
        >
          {{ product.name }}
        </a>
      </h5>

      <div class="product-price mb-3">
        {% if product.price == 0 %}
        <span class="price text-danger fw-bold fs-5">Liên hệ</span>
        {% else %}
        <span class="price d-block fw-semibold">{{ product.price|format_price }}đ</span>
        {% if product.old_price %}
        <span class="old-price text-muted text-decoration-line-through">
          {{ product.old_price|format_price }}đ
        </span>
        {% endif %}
        {% endif %}
      </div>

      <a
        href="{{ url_for('main.product_detail', slug=product.slug) }}"
        class="btn btn-warning btn-sm w-100"
      >
        <i class="bi bi-eye me-1"></i> Xem chi tiết
      </a>
    </div>
  </div>
</div>
